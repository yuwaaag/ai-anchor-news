<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <style>
        :root { --main-red: #cc0000; --gold: #ffcc00; }
        body, html { margin: 0; padding: 0; width: 1920px; height: 1080px; overflow: hidden; background: #000; font-family: 'Oswald', sans-serif; }

        /* Studio Background */
        .news-set {
            width: 100%; height: 100%;
            background: url('studio.jpg'); 
            background-size: cover;
            background-position: center;
            position: relative;
        }

        /* Mahila AI Anchor Setup */
        .anchor-box {
            position: absolute; right: 0; bottom: 0;
            width: 950px; height: 1080px; z-index: 10;
        }
        #anchorVideo {
            width: 100%; height: 100%; object-fit: contain;
        }

        /* Long News Overlay (Elegant Look) */
        .news-overlay {
            width: 100%; position: absolute; bottom: 0; z-index: 20;
            background: rgba(0, 0, 0, 0.8);
            padding: 30px 0; border-top: 5px solid var(--gold);
        }

        .headline-container {
            width: 90%; margin: 0 auto;
        }

        .headline-text {
            font-size: 55px; color: #fff; margin: 0; font-weight: bold; text-align: center;
            line-height: 1.4; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

<div class="news-set">
    <div class="anchor-box">
        <video id="anchorVideo" muted loop playsinline>
            <source src="anchor_video.mp4" type="video/mp4">
        </video>
    </div>

    <div class="news-overlay">
        <div class="headline-container">
            <p class="headline-text" id="headline">PTN NEWS: Khabrein Vistaar Se...</p>
        </div>
    </div>
</div>

<audio id="newsBGM" loop>
    <source src="https://www.soundjay.com/free-music/sounds/action-movie-trailer-01.mp3" type="audio/mpeg">
</audio>

<script>
    const SHEET_ID = '19sVzDeE9ey7da9DQe5LFYdPx7KEdHzVjffmh80LE2wE'; // Apni Nayi ID check karein
    const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`;

    let newsData = [];
    let currentIndex = 0;

    async function loadNews() {
        try {
            const response = await fetch(CSV_URL + '&cb=' + Date.now());
            const data = await response.text();
            const rows = data.split(/\r?\n/);
            // Header ko chhod kar saari news lines le raha hai
            newsData = rows.slice(1).map(r => r.replace(/^"|"$/g, '').trim()).filter(r => r !== "");
            
            if (newsData.length > 0 && !window.isPlaying) { 
                window.isPlaying = true; 
                showNext(); 
            }
        } catch (e) { console.error("Sheet Load Error"); }
    }

    function showNext() {
        if (currentIndex >= newsData.length) {
            currentIndex = 0; // Saari news khatam hone par wapas shuru karega
            loadNews(); // Nayi news check karega
            return;
        }

        const longNews = newsData[currentIndex];
        document.getElementById('headline').innerText = longNews;
        speak(longNews);
        currentIndex++;
    }

    function speak(txt) {
        window.speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance(txt);
        msg.lang = 'hi-IN';
        msg.rate = 0.95; // News padhne ki speed
        msg.pitch = 1.1; // Mahila anchor ke liye thodi sharp voice
        
        const video = document.getElementById('anchorVideo');
        
        msg.onstart = () => { 
            video.play(); // Video tab tak chalega jab tak news padhi ja rahi hai
        }; 

        msg.onend = () => { 
            video.pause(); 
            setTimeout(showNext, 3000); // Ek news khatam hone ke 3 second baad doosri shuru hogi
        };

        window.speechSynthesis.speak(msg);
    }

    // OBS Interact karke click karna zaroori hai
    window.onclick = () => {
        document.getElementById('newsBGM').volume = 0.08; // Background music ko dheema rakha hai
        document.getElementById('newsBGM').play();
        loadNews();
    };

    setInterval(loadNews, 300000); // Har 5 minute mein news update check karega
</script>

</body>
</html>
